<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>uxebu &#187; Jens Arps</title>
	<atom:link href="http://www.uxebu.com/blog/author/jarps/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.uxebu.com</link>
	<description>The first JavaScript-only development and consulting company</description>
	<lastBuildDate>Thu, 30 Jul 2015 09:10:24 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.1.8</generator>
	<item>
		<title>Bikeshed &#8211; Episode 21</title>
		<link>http://www.uxebu.com/blog/2011/12/bikeshed-episode-21/</link>
		<comments>http://www.uxebu.com/blog/2011/12/bikeshed-episode-21/#comments</comments>
		<pubDate>Wed, 21 Dec 2011 22:09:51 +0000</pubDate>
		<dc:creator><![CDATA[Jens Arps]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://uxebu.com/blog/?p=2193</guid>
		<description><![CDATA[<p>Follow @bikeshedjs for more mysterious information or visit bikeshed on the world wide web.</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/12/bikeshed-episode-21/">Bikeshed &#8211; Episode 21</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p><iframe width="640" height="360" src="//www.youtube.com/embed/pZ6L88PYyJA?feature=player_detailpage" frameborder="0" allowfullscreen></iframe></p>
<p><span id="more-2193"></span></p>
<p><iframe style="border: none;" src="http://bikeshed.uxebu.com/201112/21/" scrolling="no" width="100%" height="411"></iframe></p>
<p>Follow <a href="http://twitter.com/bikeshedjs">@bikeshedjs</a> for more <em>mysterious</em> information or visit <a href="http://bonsaijs.org">bikeshed on the world wide web</a>.</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/12/bikeshed-episode-21/">Bikeshed &#8211; Episode 21</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.uxebu.com/blog/2011/12/bikeshed-episode-21/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Bikeshed &#8211; Episode 9</title>
		<link>http://www.uxebu.com/blog/2011/12/bikeshed-episode-9/</link>
		<comments>http://www.uxebu.com/blog/2011/12/bikeshed-episode-9/#comments</comments>
		<pubDate>Fri, 09 Dec 2011 16:41:28 +0000</pubDate>
		<dc:creator><![CDATA[Jens Arps]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://uxebu.com/blog/?p=2077</guid>
		<description><![CDATA[<p>Follow @bikeshedjs for more mysterious information or visit bikeshed on the world wide web.</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/12/bikeshed-episode-9/">Bikeshed &#8211; Episode 9</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p><iframe width="640" height="360" src="//www.youtube.com/embed/rmI7zZR3a_4?feature=player_detailpage" frameborder="0" allowfullscreen></iframe></p>
<p><span id="more-2077"></span></p>
<p><iframe style="border: none; overflow: scroll" src="http://bikeshed.uxebu.com/201112/9/" scrolling="no" width="100%" height="411"></iframe></p>
<p>Follow <a href="http://twitter.com/bikeshedjs">@bikeshedjs</a> for more <em>mysterious</em> information or visit <a href="http://bonsaijs.org">bikeshed on the world wide web</a>.</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/12/bikeshed-episode-9/">Bikeshed &#8211; Episode 9</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.uxebu.com/blog/2011/12/bikeshed-episode-9/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>EmbedJS 0.2 and AMD</title>
		<link>http://www.uxebu.com/blog/2011/10/embedjs-0-2-and-amd/</link>
		<comments>http://www.uxebu.com/blog/2011/10/embedjs-0-2-and-amd/#comments</comments>
		<pubDate>Mon, 17 Oct 2011 15:43:16 +0000</pubDate>
		<dc:creator><![CDATA[Jens Arps]]></dc:creator>
				<category><![CDATA[development tools]]></category>
		<category><![CDATA[HTML5]]></category>
		<category><![CDATA[html5apps]]></category>
		<category><![CDATA[JavaScript]]></category>
		<category><![CDATA[mobile]]></category>
		<category><![CDATA[development]]></category>
		<category><![CDATA[dojo]]></category>
		<category><![CDATA[embedjs]]></category>

		<guid isPermaLink="false">http://uxebu.com/blog/?p=1843</guid>
		<description><![CDATA[<p>During JSConf.eu, we released EmbedJS 0.2. That release was mainly about a fundamental architectural change: the move to the AMD pattern for our features. Let me explain why we decided to do this, why we think this is a big step forward and what this means for the user. Modules AMD stands for &#8220;Asynchronous Module [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/10/embedjs-0-2-and-amd/">EmbedJS 0.2 and AMD</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p>During JSConf.eu, we released EmbedJS 0.2. That release was mainly about a fundamental architectural change: the move to the AMD pattern for our features. Let me explain why we decided to do this, why we think this is a big step forward and what this means for the user.<br />
<span id="more-1843"></span></p>
<h2>Modules</h2>
<p>AMD stands for &#8220;Asynchronous Module Definition&#8221;. So, what are modules? I&#8217;ll quote the definition from the <a href="http://wiki.commonjs.org/wiki/Modules/1.1" target="_blank">CommonJS Module specification</a>, as it describes it very well:</p>
<blockquote><p>This specification addresses how modules should be written in order to be interoperable among a class of module systems that can be both client and server side, secure or insecure, implemented today or supported by future systems with syntax extensions. These modules are offered privacy of their top scope, facility for importing singleton objects from other modules, and exporting their own API.</p></blockquote>
<p>So, modules are isolated parts of code that live in their own scope and are kind of self-contained. Well, that is pretty much how we see the individual Features in EmbedJS – we made our feature implementations as small as possible and reduced dependencies as much as possible. Many of EmbedJS&#8217; features are also browser-independent, so why not make it possible to use some of the tools in a non-browser environment?</p>
<p>(If you want to learn more on modules and why we need them, I recommend <a href="http://twitter.com/briancavalier" target="_blank">@briancavalier</a>&#8216;s <a href="http://briancavalier.com/presentations/pgh-js-amd-10-2011/" target="_blank">presentation on modules</a>.)</p>
<h2>Features in EmbedJS</h2>
<p>So far, I didn&#8217;t really explain what I mean with &#8220;Features&#8221;, so let me do another quote, this time from the <a href="http://uxebu.github.com/embedjs/" target="_blank">Project Page</a>:</p>
<blockquote><p>EmbedJS uses the concept of features: Functionalities are split up into features, as fine-grained as possible, and each feature might have multiple implementations.</p></blockquote>
<p>Our Features are kinda small and contain only few methods, sometimes even just one. The asyc-promise feature, for example, will get you Promises, and the transport-jsonp feature will get you a method for pull in data via jsonp – and that&#8217;s it.  If multiple methods are contained within one feature, this is because they are too closely related to each other to split them up, like the html-class feature, which contains the <code class="codecolorer text default"><span class="text">addClass</span></code>, <code class="codecolorer text default"><span class="text">removeClass</span></code>, <code class="codecolorer text default"><span class="text">toggleClass</span></code> and <code class="codecolorer text default"><span class="text">hasClass</span></code> methods.</p>
<h2>AMD vs CommonJS Modules 1.1</h2>
<p>Now that we knew modules were the way to go, there was another, quite important question to solve: There are two common patterns for modules, so which one do we want to apply? One pattern is described in the above mentioned CommonJS Wiki, the other pattern is described in the <a href="https://github.com/amdjs/amdjs-api/wiki/AMD" target="_blank">AMD wiki</a>.</p>
<p>Well, there have been <a href="http://tagneto.blogspot.com/2011/04/on-inventing-js-module-formats-and.html" target="_blank">some</a> <a href="http://unscriptable.com/index.php/2011/09/30/amd-versus-cjs-whats-the-best-format/" target="_blank">blog</a> <a href="http://blog.millermedeiros.com/2011/09/amd-is-better-for-the-web-than-commonjs-modules/" target="_blank">posts</a> lately that compare the pros and cons of each of them, so I don&#8217;t want to repeat all of this – but I&#8217;m hiving a similar tendency towards AMD. Besides this, there was another big reason to go with AMD: Remember, EmbedJS is based on the <a href="http://dojotoolkit.org/" target="_blank">Dojo Toolkit</a>, and it&#8217;s a <a href="http://dojofoundation.org/" target="_blank">Dojo Foundation Project</a> – and we hope that the efforts that went into making EmbedJS might flow back into the Dojo Toolkit one day. And as the Dojo Toolkit uses the AMD approach, the decision was quickly made to do so as well.</p>
<h2>Implications for EmbedJS</h2>
<p>There are several huge benefits for EmbedJS in using the AMD approach. The most noteworthy surely is the ease-of-use for developers. In your code, when you find you want an EmbedJS method, you <a href="http://uxebu.github.com/embedjs/docs/" target="_blank">look up the feature name</a> that provides this method, add it to the require statement and there you go. Man, easy.</p>
<p>A second important thing is that EmbedJS now plays really nice with AMD based projects. In fact, you could see EmbedJS now as a collection of small useful modules, that can be easily integrated – and also easily extended.</p>
<p>The third major benefit is that we can now get rid of all the custom tools we built around EmbedJS – you can load features with any AMD loader (though we use and recommend RequireJS) and build it with any AMD optimizer/builder (we recommend r.js).</p>
<p>Let&#8217;s have an extra word on</p>
<p><strong>Building</strong></p>
<p>It was always possible with EmbedJS to create a custom build that would contain only the features you wanted/needed in your project. But, you had to use our build tool that we created. And learning &amp; using Yet-Another-Build-Tool™ is always… well, let&#8217;s just say it would be cool to avoid it (and, not to forget, so is maintaining it). We did a lot to improve that, we created a GUI that allowed you to just &#8220;click together&#8221; the features you wanted, and we worked on a dynamic loader that would ease development. But still, the situation was far from ideal, and people just ended up going for our ready-made &#8220;kitchensink&#8221; builds that contained <em>all</em> of the features.</p>
<p>Now, we still provide those ready-made builds that contain only the implementations for a given platform (and are stripped of require/define calls), but I really hope that using the AMD approach and using an AMD optimizer to deploy will become the more adopted style.</p>
<h2>Q: Cross-target? A: The Feature Plugin</h2>
<p>One goal of EmbedJS is to allow for easy cross-device development. We got rid of run-time branching but instead went for an approach that held the different implementations for a given feature in separate files, so that one only has to deploy the actually needed code to a given device – and not all the alternate implementations, that sit useless in the device&#8217;s memory and never get used. We needed to achieve that with &#8220;in-house&#8221; means provided by the AMD approach. Lucky us, there&#8217;s the concept of <a href="https://github.com/amdjs/amdjs-api/wiki/Loader-Plugins" target="_blank">loader-plugins</a>, and so I created a <a href="https://github.com/jensarps/AMD-feature" target="_blank">feature-plugin for AMD loaders</a>. The idea is simple yet effective: You create an implementation map that maps a feature name to an implementation, and if there are multiple implementations, you supply tests that tells the plugin which feature to use.</p>
<p>When you&#8217;re ready to deploy, you have two choices: I f you really don&#8217;t know on what target your code is going to end up, you can use the dynamic implementation map containing the tests for the optimizer, and you&#8217;ll get a build that contains all of the available implementations. Then, during runtime, the feature plugin will run the tests and load the specific implementation. But, if you <em>do</em> know what target your code will run on, you provide a specific implementation map that doesn&#8217;t contain tests but directly maps to the according implementations, and you will only have those in your built file.</p>
<h2>Synopsis</h2>
<p>AMD is exactly what we needed to make EmbedJS more what we want it to be – an easy to use JavaScript toolbox that is especially handy for cross-target scenarios such as cross-platform mobile development. So, please don&#8217;t hesitate and check it out on Github, read the project page and check out the examples!</p>
<p>&nbsp;</p>
<p><strong>Resources / Further Reading</strong></p>
<ul>
<li><a href="https://github.com/uxebu/embedjs" target="_blank">EmbedJS on GitHub</a></li>
<li><a href="http://uxebu.github.com/embedjs/" target="_blank">EmbedJS Project Page</a></li>
<li><a href="http://uxebu.github.com/embedjs/docs/" target="_blank">EmbedJS API Docs</a></li>
<li><a href="https://github.com/jensarps/AMD-feature" target="_blank">AMD-Feature plugin</a></li>
<li><a href="https://github.com/amdjs/amdjs-api/wiki" target="_blank">AMD Wiki</a></li>
<li><a href="http://wiki.commonjs.org/wiki/CommonJS" target="_blank">CommonJS Wiki</a></li>
</ul>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/10/embedjs-0-2-and-amd/">EmbedJS 0.2 and AMD</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.uxebu.com/blog/2011/10/embedjs-0-2-and-amd/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		</item>
		<item>
		<title>Creating a persistent Dojo Object Store</title>
		<link>http://www.uxebu.com/blog/2011/04/creating-a-persistent-dojo-object-store/</link>
		<comments>http://www.uxebu.com/blog/2011/04/creating-a-persistent-dojo-object-store/#comments</comments>
		<pubDate>Wed, 27 Apr 2011 16:13:45 +0000</pubDate>
		<dc:creator><![CDATA[Jens Arps]]></dc:creator>
				<category><![CDATA[dojo]]></category>
		<category><![CDATA[JavaScript]]></category>
		<category><![CDATA[offline]]></category>
		<category><![CDATA[storage]]></category>

		<guid isPermaLink="false">http://uxebu.com/blog/?p=1540</guid>
		<description><![CDATA[<p>As of version 1.6, dojo comes with the new Dojo Object Store API. This is an awesome thing, as it greatly simplifies the work with data stores in Dojo. Everybody who had to do with the traditional dojo.data API felt it was overly complex and hard to use – this has finally changed now. There [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/04/creating-a-persistent-dojo-object-store/">Creating a persistent Dojo Object Store</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p>As of version 1.6, dojo comes with the new <a href="http://docs.dojocampus.org/dojo/store" target="_blank">Dojo Object Store API</a>. This is an awesome thing, as it greatly simplifies the work with data stores in Dojo. Everybody who had to do with the traditional dojo.data API felt it was overly complex and hard to use – this has finally changed now. There are also wrappers from and to the old and new APIs, so that you can do stuff like using your traditional data-aware widgets with a new Object Store. And the goodness doesn&#8217;t end here; but more on this later. If you haven&#8217;t done so yet, you might want to read the <a href="https://www.sitepen.com/blog/2011/02/15/dojo-object-stores/" target="_blank">excellent post on the new Dojo Object Stores</a> by Kris Zyp where he explains all the awesomeness he created.</p>
<p>Dojo also comes with two fresh implementations for the API, a non-persistent memory store and a JsonRest store that interacts with a server through RESTful HTTP requests. You can also observe changes made to objects in the store. What is missing is a store that uses a client-side persistent backend, which would be useful for a couple of reasons (e.g., as one commenter in that post asks, to use it as chache store for dojo.store.Cache). As Kris already mentions, it&#8217;s a piece of cake to create one, so let&#8217;s go ahead and do it!<br />
<span id="more-1540"></span></p>
<h2>Choosing the Backend</h2>
<p>The post mentions two possible candidates: dojox.storage and <a href="https://github.com/jensarps/StorageJS" target="_blank">StorageJS</a>, both already having a similar API, so making them compliant to the Dojo Object Store API is fairly easy. For this tutorial I choose StorageJS – because it is very lightweight and still provides all we need (and, well, for a couple of other reasons that don&#8217;t belong in this post). So, what is the exact API we need to comply to? Check it out <a href="http://docs.dojocampus.org/dojo/store#id2" target="_blank">in the docs</a>. See the first sentence in that paragraph? <em>&#8220;Every method in the API is optional, it&#8217;s presence indicating support for that feature.&#8221;</em> Wow, that&#8217;s nice!</p>
<h2>Basic compliance</h2>
<p>Let&#8217;s start with the methods get(), put(), add() and remove(). That will make our store pretty usable for most store scenarios.</p>
<p>First, create a &#8216;store&#8217; object we can work with (StorageJS creates a global variable called <code class="codecolorer text default"><span class="text">storage</span></code> where all it&#8217;s methods reside):</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> store <span style="color: #339933;">=</span> dojo.<span style="color: #660066;">delegate</span><span style="color: #009900;">&#40;</span>storage<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>&#8216;store&#8217; now contains everything that &#8216;storage&#8217; does, but we can leave the original &#8216;storage&#8217; object alone and modify our &#8216;store&#8217; object if needed. Time for the first method, let&#8217;s start with <code class="codecolorer text default"><span class="text">get()</span></code>. StorageJS works with Strings as keys and values only, so we need to parse what we get from it.</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">store.<span style="color: #660066;">get</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>id<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Need to parse the string we get from backend:</span><br />
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> dojo.<span style="color: #660066;">fromJson</span><span style="color: #009900;">&#40;</span>storage.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span>id<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<p>Easy one, now move on to <code class="codecolorer text default"><span class="text">put()</span></code>. The Object Store API allows user to do stuff like this: <code class="codecolorer text default"><span class="text">store.put({foo: 'bar'}, {id: 3})</span></code> as well as <code class="codecolorer text default"><span class="text">store.put({id: 3, foo: 'bar'})</span></code>. Also, StorageJS only has the method set() instead of put() and add().</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">store.<span style="color: #660066;">put</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>object<span style="color: #339933;">,</span> options<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Get the id, wherever it comes from</span><br />
&nbsp; &nbsp; <span style="color: #003366; font-weight: bold;">var</span> id <span style="color: #339933;">=</span> options <span style="color: #339933;">&amp;</span>amp<span style="color: #339933;">;&amp;</span>amp<span style="color: #339933;">;</span> options.<span style="color: #660066;">id</span> <span style="color: #339933;">||</span> object.<span style="color: #660066;">id</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Stringify data -- remember, StorageJS is a key/value backend wrapper.</span><br />
&nbsp; &nbsp; <span style="color: #003366; font-weight: bold;">var</span> data <span style="color: #339933;">=</span> dojo.<span style="color: #660066;">toJson</span><span style="color: #009900;">&#40;</span>object<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Now save the data away</span><br />
&nbsp; &nbsp; storage.<span style="color: #660066;">set</span><span style="color: #009900;">&#40;</span>id<span style="color: #339933;">,</span> data<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<p>Easy, as well – you could write this as a one-liner. Now, <code class="codecolorer text default"><span class="text">add()</span></code>. It&#8217;s close to put, except that it won&#8217;t overwrite data that already exists. So we just need to check if something with the given id already exists and throw an error if so.</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">store.<span style="color: #660066;">add</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>object<span style="color: #339933;">,</span> options<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Get the id</span><br />
&nbsp; &nbsp; <span style="color: #003366; font-weight: bold;">var</span> id <span style="color: #339933;">=</span> options <span style="color: #339933;">&amp;</span>amp<span style="color: #339933;">;&amp;</span>amp<span style="color: #339933;">;</span> options.<span style="color: #660066;">id</span> <span style="color: #339933;">||</span> object.<span style="color: #660066;">id</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Check if something exists under the given</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// id -- StorageJS always returns null when</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// there's no data for a certain key.</span><br />
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: #009900;">&#40;</span>storage.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span>id<span style="color: #009900;">&#41;</span> <span style="color: #339933;">!==</span> <span style="color: #003366; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">throw</span> <span style="color: #003366; font-weight: bold;">new</span> Error<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Object already exists&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// We're save to go now! So hand over the</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// request to the put() method.</span><br />
&nbsp; &nbsp; store.<span style="color: #660066;">put</span><span style="color: #009900;">&#40;</span>object<span style="color: #339933;">,</span> options<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<p>What about <code class="codecolorer text default"><span class="text">remove()</span></code>? Nothing to do there, it already has the desired signature and functionality.</p>
<p>That&#8217;s it, we&#8217;re done with basic compliance. Our &#8216;store&#8217; object now implements the basic methods of the Dojo Object Store API and can be used by anything that can work with a Dojo Object Store – and it will keep it&#8217;s state persistent in the browser.</p>
<h2>More compliance? Querying!</h2>
<p>There&#8217;s one interesting thing in the API: the <code class="codecolorer text default"><span class="text">query()</span></code> method. Uh, yeah, we want that! Lucky us, Dojo already provides a query engine as well as a method that makes sure there are iterative methods and a <code class="codecolorer text default"><span class="text">total</span></code> property containing the number of hits available in our result (well, it also abstracts away the differences between sync and async results, but as StorageJS is purely synchronous, this is not important to us). First, define a queryEngine:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #006600; font-style: italic;">// Let's take the provided queryEngine :)</span><br />
store.<span style="color: #660066;">queryEngine</span> <span style="color: #339933;">=</span> dojo.<span style="color: #660066;">store</span>.<span style="color: #660066;">util</span>.<span style="color: #660066;">SimpleQueryEngine</span><span style="color: #339933;">;</span></div></div>
<p>So, if we want our store to be able to run queries, all we need to do is to take the store&#8217;s data and hand it over to the query engine. We use StorageJS&#8217; getAll() method to acquire the data. It will return an array of objects in the form { key: &#8216;theKey&#8217;, value: &#8216;theValue&#8217;}, but the queryEngine wants an array containing only the objects, so we need to do a conversion.</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">store.<span style="color: #660066;">query</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>query<span style="color: #339933;">,</span> options<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Get all data from the backend</span><br />
&nbsp; &nbsp; <span style="color: #003366; font-weight: bold;">var</span> rawData <span style="color: #339933;">=</span> storage.<span style="color: #660066;">getAll</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// And convert it into a format that the</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// queryEngine can work with</span><br />
&nbsp; &nbsp; <span style="color: #003366; font-weight: bold;">var</span> data <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">var</span> i <span style="color: #339933;">=</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> l <span style="color: #339933;">=</span> rawData.<span style="color: #660066;">length</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&amp;</span>lt<span style="color: #339933;">;</span> l<span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #003366; font-weight: bold;">var</span> <span style="color: #000066; font-weight: bold;">item</span> <span style="color: #339933;">=</span> rawData<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #003366; font-weight: bold;">var</span> dataObject <span style="color: #339933;">=</span> dojo.<span style="color: #660066;">fromJson</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">item</span>.<span style="color: #660066;">value</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; data.<span style="color: #660066;">push</span><span style="color: #009900;">&#40;</span>dataObject<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Now call the queryEngine on the data</span><br />
&nbsp; &nbsp; <span style="color: #003366; font-weight: bold;">var</span> results <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">queryEngine</span><span style="color: #009900;">&#40;</span>query<span style="color: #339933;">,</span> options<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span>data<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// And return the result, after it has been</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// enhanced.</span><br />
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> dojo.<span style="color: #660066;">store</span>.<span style="color: #660066;">util</span>.<span style="color: #660066;">QueryResults</span><span style="color: #009900;">&#40;</span>results<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>Now we can query our store for specific data, like so: <code class="codecolorer text default"><span class="text">var results = store.query({ prime: true });</span></code> This will give us all objects in the store that have a property called &#8216;prime&#8217; and have that property set to true.</p>
<h2>Hierarchie and Transactions</h2>
<p>The API also mentions methods about data hierarchie and transactions, but I&#8217;m not going to cover these in this tutorial.</p>
<h2>Convenience and Optimization</h2>
<p>Currently, every time we run a query, we fetch all data again from our storage engine. So, if you don&#8217;t have a massive amount of data and want to query the store a lot, it might be wise to maintain a copy of all data in memory. There are other things you could optimize as well – or you could write your own queryEngine.</p>
<p>For your convenience,  <a href="http://statis.uxebu.com/~jens/dojo.store/PersistentLocal.js" target="_blank">here&#8217;s a wrapper</a> that creates a Dojo Object Store like we did above and accepts a useMemory parameter during instantiation that denotes whether a copy of the data should be kept in memory or not. It uses the traditional require/provide instead of the AMD format. If you want to use it, make sure you use the right namespace in the declare() call! (Or, not recommended, copy it in the /dojo/store directory.)</p>
<p>If you want to fool around with it in the console first, you can go <a href="http://static.uxebu.com/~jens/dojo.store/index-persistent-nomemory.html" target="_blank">here (non-memory-using)</a> or <a href="http://static.uxebu.com/~jens/dojo.store/index-persistent-usememory.html" target="_blank">here (memory-using)</a>, check out the source and fire up the console and try things out.</p>
<h2>Getting StorageJS</h2>
<p>The above code uses the features base and getAll, so you could do a specific build of StorageJS with these features or just <a href="https://github.com/jensarps/StorageJS/tree/master/builds?raw=true" target="_blank">grab a full build</a> of it for your desired storage engine (the storage-full-[engine].js files). If you don&#8217;t know about storage engines, all modern browser support localStorage, so <a href="https://github.com/jensarps/StorageJS/raw/master/builds/storage-full-localStorage.js" target="_blank">this is the one</a> what you might want.</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/04/creating-a-persistent-dojo-object-store/">Creating a persistent Dojo Object Store</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.uxebu.com/blog/2011/04/creating-a-persistent-dojo-object-store/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Using IndexedDB on Firefox</title>
		<link>http://www.uxebu.com/blog/2011/03/using-indexeddb-on-firefox/</link>
		<comments>http://www.uxebu.com/blog/2011/03/using-indexeddb-on-firefox/#comments</comments>
		<pubDate>Wed, 30 Mar 2011 14:55:00 +0000</pubDate>
		<dc:creator><![CDATA[Jens Arps]]></dc:creator>
				<category><![CDATA[frontend engineering]]></category>
		<category><![CDATA[HTML5]]></category>
		<category><![CDATA[JavaScript]]></category>
		<category><![CDATA[firefox]]></category>
		<category><![CDATA[IDB]]></category>
		<category><![CDATA[indexedDB]]></category>
		<category><![CDATA[offline]]></category>
		<category><![CDATA[storage]]></category>

		<guid isPermaLink="false">http://uxebu.com/blog/?p=1494</guid>
		<description><![CDATA[<p>As Firefox 4 is now stable, chances are that the async IDB (IndexedDB) API is not going to change anymore. But IDB is not localStorage – it can be a major pain to work with. So, here is a guide on how to use IDB in Firefox as a key-value store. TL;DR There is example code [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/03/using-indexeddb-on-firefox/">Using IndexedDB on Firefox</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p>As Firefox 4 is now stable, chances are that the async IDB (IndexedDB) API is not going to change anymore. But IDB is not localStorage – it can be a major pain to work with. So, here is a guide on how to use IDB in Firefox as a key-value store.</p>
<p><em><strong>TL;DR</strong></em><br />
There is example code available at the end of the post. If you don‘t want to read this lengthy post and/or prefer to jump right in the middle of the action, grab the example implementation and play around with it.<br />
<span id="more-1494"></span></p>
<h1>Key-Value Store? But, IDB is a full-blown database!</h1>
<p>Yes, it is. But I still argue that in WebApp context a key-value store will cover about 90% of use cases. So I won‘t cover in this post how to create fancy key ranges or how to create multiple indices. But I will cover the five basic methods that you will need to work with any store: get, set, remove, getAll and clear – this will enable you to work with IDB and give you an understanding of how it works. You‘re then of course heartly encouraged to explore it and it‘s features further!</p>
<h1>A word on requests, transactions and events</h1>
<p>As long as the sync API is not there, all operations are async. That means that you will make requests. All the time. These requests will have an onerror and an onsuccess property, where you can put your callbacks/handlers in. If your request was successful, you will get an event in your callback. That event contains a lot of useful and useless information, but what you will want to look at in most cases is event.target.result – this is where your result lives in. In most cases, you will have to start a transaction before; inside of the transaction, you can access the objectStore and make your request. However, there are different types of transactions, but you will get the details below.</p>
<h1>Getting the Object Store ready to use</h1>
<p>Yep, it‘s not that you can just start away and store your data, there‘s some work to do ahead…</p>
<h2>Open the Database</h2>
<p>Easy one:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> openRequest <span style="color: #339933;">=</span> mozIndexedDB.<span style="color: #000066;">open</span><span style="color: #009900;">&#40;</span>dbName<span style="color: #339933;">,</span> dbDescription<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
openRequest.<span style="color: #660066;">onsuccess</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>event<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//event.target.result contains a reference to the db</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p><code class="codecolorer text default"><span class="text">event.target.result</span></code> then contains a reference to the database. Store it, you will need it.</p>
<h2>Creating/Opening the ObjectStore</h2>
<p>That‘s a little tougher. Some operations, such as creating and deleting object stores, require the database to be in a „mutation transaction state“. Wow. Well, there‘s only one way to put the db into this state, and that‘s via a <code class="codecolorer text default"><span class="text">setVersion</span></code> request. If you are opening the db for the first time ever, you will need to do this anyway. You can, of course, change the version of the database anytime, which might be a useful thing if you, e.g., change the structure of how your objectStore saves the data. To check what version the database in the user‘s browser has, you can check the <code class="codecolorer text default"><span class="text">version</span></code> property in the reference to the database anytime.</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> versionRequest <span style="color: #339933;">=</span> db.<span style="color: #660066;">setVersion</span><span style="color: #009900;">&#40;</span>dbVersion<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
versionRequest.<span style="color: #660066;">onsuccess</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">// Woohoo, the database is in a mutation transaction!!</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<p>Inside of the callback function, you can now check if your store already exists, or if you need to create it. The reference to your db contains an object called <code class="codecolorer text default"><span class="text">objectStoreNames</span></code>, which is a list of existing objectStores. As this is a DOMStringList, it features the handy <code class="codecolorer text default"><span class="text">contains()</span></code> method:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> hasMyStore <span style="color: #339933;">=</span> db.<span style="color: #660066;">objectStoreNames</span>.<span style="color: #660066;">contains</span><span style="color: #009900;">&#40;</span>storeName<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>If the store is not there, you need to create it via the <code class="codecolorer text default"><span class="text">createObjectStore()</span></code> method. It takes two arguments: the name of the store, and an object with two properties: <code class="codecolorer text default"><span class="text">keyPath</span></code> and <code class="codecolorer text default"><span class="text">autoIncrement</span></code>. keyPath is… well… the path to the key. Think of it as the one column that is the primary key in your data table (you all did some MySQL at some time, I bet). You can do really fancy things with the keyPath in objectStores, but it‘s perfectly fine to just use something like „id“ as the keyPath. If you want to store an object and want to provide the keyPath, all you need to do is let the object you want to store have a property with the name of the keyPath, and a unique value. Uh, it‘s not that complicated, examples will follow. AutoIncrement is, well, autoIncrement. You have the option to let the objectStore take care for the uniqueness of it‘s data‘s keyPath properties, or do it yourself.</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> store <span style="color: #339933;">=</span> db.<span style="color: #660066;">createObjectStore</span><span style="color: #009900;">&#40;</span>storeName<span style="color: #339933;">,</span> <span style="color: #009900;">&#123;</span>keyPath<span style="color: #339933;">:</span> <span style="color: #3366CC;">'id'</span><span style="color: #339933;">,</span> autoIncrement<span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>You immediately get a reference to the newly created objectStore, so save it.</p>
<p>If the store is already there, you need to open it. Um, well, you don‘t really have to open it, but you might want to obtain a reference to it, just to make sure that it really exists. To do this, you need to start a transaction via the <code class="codecolorer text default"><span class="text">transaction()</span></code> method. It accepts three arguments: an array of store names (the ones which you want to work with), an integer denoting whether you want to read and/or write during that transaction, and a timeout. There are constants for read/write you can use for better readability in your code, you can find them at <code class="codecolorer text default"><span class="text">IDBTransaction.READ_ONLY</span></code> and <code class="codecolorer text default"><span class="text">IDBTransaction.READ_WRITE</span></code>. The timeout parameter is optional. That method returns a transaction object that contains a method called <code class="codecolorer text default"><span class="text">objectStore</span></code>, which you can use to access your store. This is the „default“ way transactions work; the mutation transaction above is an eception to this, where you need to be in the callback of the transaction to modify the database.</p>
<p>In our case, we can start an „empty“ transaction:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> emptyTransaction <span style="color: #339933;">=</span> db.<span style="color: #660066;">transaction</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> IDBTransaction.<span style="color: #660066;">READ_ONLY</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #003366; font-weight: bold;">var</span> store <span style="color: #339933;">=</span> emptyTransaction.<span style="color: #660066;">objectStore</span><span style="color: #009900;">&#40;</span>storeName<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>There you have your reference to the store.</p>
<h1>Data Manipulation</h1>
<p>Now that the store is ready to use, it‘s time to store some data in it. To do so, you need to start a transaction, access the object store, and call the store‘s <code class="codecolorer text default"><span class="text">put</span></code> method:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> putTransaction <span style="color: #339933;">=</span> db.<span style="color: #660066;">transaction</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span>storeName<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> IDBTransaction.<span style="color: #660066;">READ_WRITE</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #003366; font-weight: bold;">var</span> putRequest <span style="color: #339933;">=</span> putTransaction.<span style="color: #660066;">objectStore</span><span style="color: #009900;">&#40;</span>storeName<span style="color: #009900;">&#41;</span>.<span style="color: #660066;">put</span><span style="color: #009900;">&#40;</span>dataObj<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
putRequest.<span style="color: #660066;">onsuccess</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>event<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//event.target.result contains the value of the keyPath of the data written (the „key“)</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<p>That‘s all. This type of transaction is what you also use for other data manipulation tasks, for example to retrieve data:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> getTransaction <span style="color: #339933;">=</span> db.<span style="color: #660066;">transaction</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span>storeName<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> IDBTransaction.<span style="color: #660066;">READ_ONLY</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #003366; font-weight: bold;">var</span> getRequest <span style="color: #339933;">=</span> getTransaction.<span style="color: #660066;">objectStore</span><span style="color: #009900;">&#40;</span>storeName<span style="color: #009900;">&#41;</span>.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span>key<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
getRequest.<span style="color: #660066;">onsuccess</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>event<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//event.target.result contains the data object</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<p>You will need to provide the key of the stored entry to get it; as you need to do when you want to remove it:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> removeTransaction <span style="color: #339933;">=</span> db.<span style="color: #660066;">transaction</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span>storeName<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> IDBTransaction.<span style="color: #660066;">READ_WRITE</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #003366; font-weight: bold;">var</span> deleteRequest <span style="color: #339933;">=</span> removeTransaction.<span style="color: #660066;">objectStore</span><span style="color: #009900;">&#40;</span>storeName<span style="color: #009900;">&#41;</span>.<span style="color: #000066; font-weight: bold;">delete</span><span style="color: #009900;">&#40;</span>key<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
deleteRequest.<span style="color: #660066;">onsuccess</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>event<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//event.target.result contains the key of the deleted data object</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<p>If you want to get all data objects from the store:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> getAllTransaction <span style="color: #339933;">=</span> db.<span style="color: #660066;">transaction</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span>storeName<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> IDBTransaction.<span style="color: #660066;">READ_ONLY</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #003366; font-weight: bold;">var</span> getAllRequest <span style="color: #339933;">=</span> getAllTransaction.<span style="color: #660066;">objectStore</span><span style="color: #009900;">&#40;</span>storeName<span style="color: #009900;">&#41;</span>.<span style="color: #660066;">getAll</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
getAllRequest.<span style="color: #660066;">onsuccess</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>event<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//event.target.result contains an array of all data objects</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<p>And, finally, if you want to clear (i.e., delete all data objects) the store:</p>
<div class="codecolorer-container javascript default" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><div class="javascript codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #003366; font-weight: bold;">var</span> clearTransaction <span style="color: #339933;">=</span> db.<span style="color: #660066;">transaction</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span>storeName<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> IDBTransaction.<span style="color: #660066;">READ_WRITE</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #003366; font-weight: bold;">var</span> clearRequest <span style="color: #339933;">=</span> clearTransaction.<span style="color: #660066;">objectStore</span><span style="color: #009900;">&#40;</span>storeName<span style="color: #009900;">&#41;</span>.<span style="color: #660066;">clear</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
clearRequest.<span style="color: #660066;">onsuccess</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>event<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">//event.target.result contains undefined</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></div></div>
<h1>But how‘s this better than localStorage?</h1>
<p>It isn‘t. Yeah, well, it is, as you can store objects and don‘t have to stringify them before. But basically, to get the real advantages of IDB, you will need to dive deeper into it. Features like keyRanges remove the need to do map/reduce action when you search for items in your store. But now you have an idea of how the whole thing works. If you want to go further, browse in the spec or the MDC docs and try things out!</p>
<p><strong>Example Code</strong></p>
<p>There is an example page over here: <a href="http://static.uxebu.com/~jens/indexeddb/ff-idb.html" target="_blank">http://static.uxebu.com/~jens/indexeddb/ff-idb.html</a>.</p>
<p>It uses an ObjectStore wrapper I created using dojo that covers the basic methods mentioned above, the JavaScript is here: <a href="http://static.uxebu.com/~jens/indexeddb/idb-ff.js" target="_blank">http://static.uxebu.com/~jens/indexeddb/idb-ff.js</a>.</p>
<p>When you open the page, open the console and you will see some messages there. Check out the source to see what‘s going on; it‘s basically a round trip through all the basic methods.</p>
<p><strong>Further Reading</strong></p>
<ul>
<li>The spec: <a href="http://www.w3.org/TR/IndexedDB/" target="_blank">http://www.w3.org/TR/IndexedDB/</a></li>
<li>The MDC article: <a href="https://developer.mozilla.org/en/IndexedDB" target="_blank">https://developer.mozilla.org/en/IndexedDB</a></li>
</ul>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/03/using-indexeddb-on-firefox/">Using IndexedDB on Firefox</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.uxebu.com/blog/2011/03/using-indexeddb-on-firefox/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Explaining EmbedJS</title>
		<link>http://www.uxebu.com/blog/2011/01/explaining-embedjs/</link>
		<comments>http://www.uxebu.com/blog/2011/01/explaining-embedjs/#comments</comments>
		<pubDate>Mon, 31 Jan 2011 14:02:28 +0000</pubDate>
		<dc:creator><![CDATA[Jens Arps]]></dc:creator>
				<category><![CDATA[development tools]]></category>
		<category><![CDATA[dojo]]></category>
		<category><![CDATA[frontend engineering]]></category>
		<category><![CDATA[JavaScript]]></category>
		<category><![CDATA[mobile]]></category>
		<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[uxebu]]></category>
		<category><![CDATA[development]]></category>
		<category><![CDATA[embedjs]]></category>
		<category><![CDATA[memory usage]]></category>
		<category><![CDATA[optimize]]></category>
		<category><![CDATA[performance]]></category>

		<guid isPermaLink="false">http://uxebu.com/blog/?p=1366</guid>
		<description><![CDATA[<p>Last week, we tagged the current state of EmbedJS 0.1. This is a large step for us, and something we have been waiting for and wanting to do for a long time. And with doing so, the need arises to answer a lot of questions – and we better start sooner than later. So, here [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/01/explaining-embedjs/">Explaining EmbedJS</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p>Last week, we tagged the current state of EmbedJS 0.1. This is a large step for us, and something we have been waiting for and wanting to do for a long time. And with doing so, the need arises to answer a lot of questions – and we better start sooner than later. So, here it is, the first part of „Explaining EmbedJS“.</p>
<h2>What is it?</h2>
<p>It‘s a JavaScript Toolkit, especially aimed at embedded devices. Embedded devices, that is phones, tablet devices, TVs, car dashboards and the like. Devices that are capable of running JavaScript. We are sure that this list is going to grow over time – and will hopefully one day also include devices like your fridge. EmbedJS is based on the Dojo Toolkit.<br />
<span id="more-1366"></span></p>
<h2>Why?</h2>
<p>Because the toolkits and frameworks that exist focus on desktop browsers and therefore have a different approach – an approach we didn‘t find that suitable for embedded/mobile development. And the JS frameworks that target mobile devices are flawed, too: either they target only a specific device or platform, or they provide far more than we do need and want.</p>
<p>What we wanted was a toolkit that offered a unified API across different platforms, but with the best implementation that was available for each platform. And we didn‘t want to ship code that implemented a certain feature for, say, an old Blackberry device to an iPhone. Plus, we wanted that API to be small – enough to assist us in our daily work, but not that bloated that we would ship code to a phone that we wouldn‘t need in most of our projects.</p>
<h2>The Dojo Toolkit</h2>
<p>We at uxebu have a strong affinity to the <a href="http://dojotoolkit.org/" target="_blank">Dojo Toolkit</a> – most of us are committers – for a good reason: we believe that it has done many things right, and that it has an excellent code quality. Thus, finding a starting point for our venture to what was later to be EmbedJS was pretty easy: It was the very core of the Dojo Toolkit, dojo._base.</p>
<p>We examined the code and split it into its smallest parts (features, how we call them in EmbedJS). After having the features all nicely separated, we could look for the best implementation for each of the platforms we wanted to support, and put it into a separate file. Then we optimized our code, tweaking here and there, but also using the code from dojo._base as it was, because it already was the best implementation.</p>
<p>And we needed to find means to put all these tiny parts together again, respecting any given dependecies, to create a file that then contained all the feature‘s implementations for a given platform – so the EmbedJS Tools were born, including our highly flexible build system.</p>
<h2>API</h2>
<p>EmbedJS‘ API is a small subset on Dojo‘s API. It provides around 70 methods, from the fields language enhancement (like Array manipulation or JSON), OO (like classes and inheritance), transport (like JSONP or XHR), event system (like connecting to DOM events or methods), DOM manipulation (like style or node creation) and misc things like Promises or pub/sub.</p>
<p>We kept the method signatures intact so that you can import your existing knowledge from working with the Dojo Toolkit to EmbedJS. There are only a few minor changes where we<br />
a) found a new name highly useful, e.g <code class="codecolorer text default"><span class="text">dojo.io.script.get()</span></code> is <code class="codecolorer text default"><span class="text">embed.jsonp()</span></code><br />
b) we needed to strip given functionality for the sake of code size.</p>
<p>All methods in EmbedJS are available under the embed namespace as well as under the dojo namespace. I.e. to call the connect method you can use <code class="codecolorer text default"><span class="text">dojo.connect()</span></code> and <code class="codecolorer text default"><span class="text">embed.connect()</span></code>.</p>
<p>The full API documentations is <a href="http://embedjs.org/apidocs/dools/app/apidoc/embedjs/" target="_blank">here</a>, though it‘s undergoing some updates right now.</p>
<h2>Summary</h2>
<p>I didn‘t want to dig too deep in the first article on EmbedJS, but I guess you got the point: EmbedJS is a highly optimized Dojo core, and offers you a specialized, optimal build for a given platform. To explain how the build system works, how we manage dependencies, how we separate our features and our implementations and how one can create a project-oriented custom build will need another blog post – but if you are too curious, you are invited to take a look at <a href="https://github.com/uxebu/embedjs" target="_blank">the source code at github</a>; a lot is self-explenatory there. A further source of information is the <a href="http://uxebu.github.com/embedjs/" target="_blank">EmbedJS project page</a>, as well as the <a href="https://github.com/uxebu/embedjs-tools" target="_blank">EmbedJS Tools source</a>.</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/01/explaining-embedjs/">Explaining EmbedJS</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.uxebu.com/blog/2011/01/explaining-embedjs/feed/</wfw:commentRss>
		<slash:comments>6</slash:comments>
		</item>
		<item>
		<title>indexedDB Updates &#8211; FF4.09b</title>
		<link>http://www.uxebu.com/blog/2011/01/indexeddb-updates-ff4-09b/</link>
		<comments>http://www.uxebu.com/blog/2011/01/indexeddb-updates-ff4-09b/#comments</comments>
		<pubDate>Mon, 17 Jan 2011 15:52:26 +0000</pubDate>
		<dc:creator><![CDATA[Jens Arps]]></dc:creator>
				<category><![CDATA[frontend engineering]]></category>
		<category><![CDATA[JavaScript]]></category>
		<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[firefox]]></category>
		<category><![CDATA[HTML5]]></category>
		<category><![CDATA[IDB]]></category>
		<category><![CDATA[indexedDB]]></category>
		<category><![CDATA[offline]]></category>
		<category><![CDATA[storage]]></category>

		<guid isPermaLink="false">http://uxebu.com/blog/?p=1344</guid>
		<description><![CDATA[<p>IndexedDB is all the buzz right now, but it is pretty hard to find information about it&#8217;s implementations. In addition to that, the impls change on a weekly basis. So I figured it would be nice to summarize every now and then what has been happening around IDB in the last time. And as Mozilla [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/01/indexeddb-updates-ff4-09b/">indexedDB Updates &#8211; FF4.09b</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p>IndexedDB is all the buzz right now, but it is pretty hard to find information about it&#8217;s implementations. In addition to that, the impls change on a weekly basis. So I figured it would be nice to summarize every now and then what has been happening around IDB in the last time.</p>
<p>And as Mozilla released a new Firefox 4 beta these days, and introduces changes to it&#8217;s IDB impl, let&#8217;s start the series with a brief summary of the most important of these changes.<br />
<span id="more-1344"></span></p>
<h2>Changes in 4.09b</h2>
<ul>
<li>The indexedDB object has been renamed: <code class="codecolorer text default"><span class="text">moz_indexedDB</span></code> is now <code class="codecolorer text default"><span class="text">mozIndexedDB</span></code>.</li>
<li>When opening a database, the event handed over to the onsuccess callback no more has a property called &#8220;result&#8221;, where a reference to the databasse used to be; it is now available at <code class="codecolorer text default"><span class="text">event.target.result</span></code> (event.target contains the IDBRequest).</li>
<li>This applies to many (all?) cases, where you&#8217;d expect the result of a request to live in event.result, where it now is in event.target.result.</li>
<li>When creating an object store, the second argument, <code class="codecolorer text default"><span class="text">keyPath</span></code>, now has to be passed as a property inside of an object: <code class="codecolorer text default"><span class="text">{keyPath: &quot;keyPathName&quot;}</span></code></li>
<li>When creating an objectStore, the third argument, <code class="codecolorer text default"><span class="text">autoIncrement</span></code>, is dropped and now has to be part of the second argument: <code class="codecolorer text default"><span class="text">{autoIncrement: true}</span></code></li>
<li>Methods that read from an objectStore now only seem to work inside of a transaction; before, it was allowed to call methods like get directly.</li>
<li>keyRange support seems to have increased. However, I&#8217;m not really interested (right now) in keyRanges and queries, so I did not play around with these.</li>
</ul>
<p>Note that the changes for the <code class="codecolorer text default"><span class="text">createObjectStore</span></code> arguments are against the spec &#8211; the 4.08b was compliant, the 4.09b is no more. But, on the other hand, it is now closer to the Chrome impl, which also expects an object as second argument (but has no support for autoIncrement).</p>
<h2>What it does *not* have (yet)</h2>
<p>The <a href="http://www.w3.org/TR/IndexedDB/#sync-database" target="_blank">sync API</a>. Alas. To me, the snychronous implementation is exactly what makes indexedDB that attractive – I&#8217;m not a fan of databases and I don&#8217;t like to start transactions, iterate over resultSets and the like… I want a store with easy access. Seriously, in most real life scenarios, an async approach won&#8217;t get you anywhere but displaying a waiting message to your user, because you can&#8217;t go on until you have the data from the store.</p>
<h2>More info?</h2>
<p>If you want to stay in touch with what happens around the indexedDB impl, the best place to go ist the Mozilla bugtracker. Um, yeah, reading browser source code can be no fun at times, but it gets you as close as you can get. Or, check what happens in the test files.</p>
<h2>Need working code?</h2>
<p>The *only* place to get reliable, working code is the test files in the repository. Seriously, there&#8217;s so much code out there claiming to work, but it simply doesn&#8217;t. And even if it did one day, it might break the other day, after changes have been made to the impl. And there will be *lots* of changes in the future.</p>
<h2>Where are these test files?</h2>
<p>In the repo. To see them online, go here: <a href="http://hg.mozilla.org/mozilla-central/file/" target="_blank">http://hg.mozilla.org/mozilla-central/file/</a> and then navigate to dom/indexedDB/test.</p>
<h2>Something else?</h2>
<p>Nope, not really. There don&#8217;t seem to be any *major* changes for 4.09b – I hope you still found this short summary useful.</p>
<p>I hope to continue this series about IDB and post about different IDB topics every now and then  – so if you want to know more about indexedDB in general, or something specific, just drop a line in the comments!</p>
<h3>Further reading</h3>
<ul>
<li>The spec: <a href="http://www.w3.org/TR/IndexedDB/" target="_blank">http://www.w3.org/TR/IndexedDB/</a></li>
<li>The MDC article: <a href="https://developer.mozilla.org/en/IndexedDB" target="_blank">https://developer.mozilla.org/en/IndexedDB</a></li>
</ul>
<p>The post <a rel="nofollow" href="http://www.uxebu.com/blog/2011/01/indexeddb-updates-ff4-09b/">indexedDB Updates &#8211; FF4.09b</a> appeared first on <a rel="nofollow" href="http://www.uxebu.com">uxebu</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.uxebu.com/blog/2011/01/indexeddb-updates-ff4-09b/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>
